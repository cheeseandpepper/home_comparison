<h1>Settings</h1>

<div class='well'>
  <div class='row'>
    <div class='col-xs-6'>
      Create, edit, or destroy feature types here.
      <%= link_to "Edit user settings", edit_user_registration_path(current_user.id)%>
    </div>

    <div class='col-xs-6'>
      
    </div>

  </div>
</div>


<%= form_tag('/settings', method: :put, remote: true) do %>
  <button><%= link_to 'New Feature', new_feature_type_path %></button>

  <%= submit_tag %>
  <table class='table'>
    <thead>
      <tr>
        <th>Name</th>
        <th>Weight</th>
        <th colspan="3"></th>
      </tr>
    </thead>

    <tbody>
      <% @feature_types.each do |feature| %>
        <tr data-feature-type-id="<%= feature.id %>">
          <td><%= text_field_tag "feature_types[#{feature.id}][name]", feature.name %></td>
          <td><%= number_field_tag "feature_types[#{feature.id}][weight]", feature.weight %></td>
          <td><%= link_to 'Destroy', feature_type_path(feature.id), method: :delete, data: { confirm: 'Are you sure?' } %></td>
        </tr>
      <% end %>
    </tbody>
  </table>
<% end %>

<br>



<script>

// $('tr input').on('change', function(event) {
//   var target    = event.target;
//   var column    = target.id.split('-')[1];
//   var value     = target.value;
//   var featureId = $(target).closest('tr').data('feature-id')
//   var houseId   = $(target).closest('tr').data('house-id')
  
//   var data = {};
//   data[column] = value;
//   var url = '/houses/' + houseId + '/features/' + featureId;

//   $.ajax({
//     type: 'PUT',
//     url: url,
//     dataType: 'json',
//     data: { feature: data },
//     success: function(data) {
//       var score = data.score;
//       var maxScore = data.max_score;
//       var overallScore = data.overall_score;

//       $('.score-list').find('#house-score').text(score)
//       $('.score-list').find('#house-max-score').text(maxScore)
//       $('.score-list').find('#house-overall-score').text(overallScore)  

//     }
//   })
// })

</script>